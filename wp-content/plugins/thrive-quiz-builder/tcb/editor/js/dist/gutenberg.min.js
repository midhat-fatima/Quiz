/*! Thrive Architect - 2019-08-14
* http://www.thrivethemes.com/
* Copyright (c) 2019 Thrive Themes */

!function(n){var t=function(){return"undefined"!=typeof wp&&void 0!==wp.blocks},e=function(){var e=n("#editor"),t=n("#thrive-gutenberg-switch").html(),i=n("<div>").append(t),o=i.find("#thrive_preview_button");setTimeout(function(){-1!==t.indexOf("postbox")?(e.find(".editor-post-title").append(i),e.find(".editor-block-list__layout").hide(),e.find(".editor-post-title__block").css("margin-bottom","0"),e.find(".editor-writing-flow__click-redirect").hide(),e.find(".edit-post-header-toolbar").css("visibility","hidden")):(e.find(".edit-post-header-toolbar").append(o),o.on("click",function(){e.find(".editor-block-list__layout").hide()}),e.find(".edit-post-header-toolbar").css("visibility","visible")),n("#tcb2-show-wp-editor").on("click",function(){var t=e.find(".tcb-enable-editor").closest(".postbox");n.ajax({type:"post",url:ajaxurl,dataType:"json",data:{_nonce:TCB_Post_Edit_Data.admin_nonce,post_id:this.getAttribute("data-id"),action:"tcb_admin_ajax_controller",route:"disable_tcb"}}).done(function(t){}),t.next(".tcb-flags").find("input").prop("disabled",!1),t.remove(),e.find(".editor-block-list__layout").show(),e.find(".edit-post-header-toolbar").append(o),e.find(".edit-post-header-toolbar").css("visibility","visible")}),o.on("click",function(){n.ajax({type:"post",url:ajaxurl,dataType:"json",data:{_nonce:TCB_Post_Edit_Data.admin_nonce,post_id:this.getAttribute("data-id"),action:"tcb_admin_ajax_controller",route:"change_post_status_gutenberg"}})}),n(".tcb-revert").on("click",function(){confirm("Are you sure you want to DELETE all of the content that was created in this landing page and revert to the theme page? \n If you click OK, any custom content you added to the landing page will be deleted.")&&(location.href=location.href+"&tve_revert_theme=1",e.find(".edit-post-header-toolbar").css("visibility","visible"))}),n(window).on("storage.tcb",function(t){var e=wp.data.select("core/editor").getCurrentPost(),i=JSON.parse(t.originalEvent.newValue);"tve_post_options_change"===t.originalEvent.key&&i.ID===Number(e.id)&&window.location.reload()}),wp.data.subscribe(function(){var t=wp.data.select("core/editor").isSavingPost(),e=wp.data.select("core/editor").isAutosavingPost();if(t&&!e){var i=JSON.stringify(wp.data.select("core/editor").getCurrentPost());window.localStorage.setItem("tve_post_options_change",i)}})},1)};n(function(){t()&&e()})}(jQuery);